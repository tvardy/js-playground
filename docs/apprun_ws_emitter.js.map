{
  "version": 3,
  "sources": ["../src/js/apprun_ws_emitter.jsx"],
  "sourcesContent": ["/* global app, io */\nimport { LEVELS, Log } from './tools/Logger.js'\nimport { randomRange } from './utils/random.js'\nimport { wsConnect } from './utils/wsConnect.js'\n\nimport { constants } from './apprun_ws_common.js'\n\nif (process.env.NODE_ENV === 'development') {\n  Log.logLevel = LEVELS.DEBUG\n}\n\nLog.debug('AppRun Client script started!')\n\nconst view = ({ status, sending }) => (\n  <>\n    <h1>Emitter Works!</h1>\n    <h2>Status: {status}</h2>\n    <button onclick=\"app.run('toggle')\">{sending ? 'Pause' : 'Play'}</button>\n    <p>See browser console if you want to trace the data being sent</p>\n  </>\n)\n\nconst update = {\n  async init (state) {\n    try {\n      App.ws = await wsConnect(constants.URL)\n\n      Log.debug('WS connected')\n\n      App.run('wait')\n\n      return {\n        ...state,\n        status: 'connected'\n      }\n    } catch (e) {\n      Log.error('WS error:', e)\n\n      return {\n        ...state,\n        status: 'error'\n      }\n    }\n  },\n  wait (state) {\n    if (state.sending) {\n      const time = randomRange(constants.NUMBERS.time.min, constants.NUMBERS.time.max)\n\n      setTimeout(() => App.run('sendValue'), time)\n    }\n\n    return state\n  },\n  sendValue (state) {\n    const value = randomRange(\n      constants.NUMBERS.values.min,\n      constants.NUMBERS.values.max\n    )\n\n    Log.info('new value:', value)\n\n    App.ws.emit('data', value)\n\n    App.run('wait')\n\n    return state\n  },\n  toggle (state) {\n    const newState = {\n      ...state,\n      sending: !state.sending\n    }\n\n    if (newState.sending) {\n      setTimeout(() => App.run('wait'), 0)\n    }\n\n    return newState\n  }\n}\n\nconst App = app.start(\n  constants.APP_ROOT,\n  { status: 'connecting', sending: true },\n  view,\n  update\n)\n\nApp.run('init')\n"],
  "mappings": "yKAWA,EAAI,MAAM,iCAEV,GAAM,GAAO,CAAC,CAAE,SAAQ,aACtB,wBACE,MAAC,KAAD,KAAI,kBACJ,MAAC,KAAD,KAAI,WAAS,GACb,MAAC,SAAD,CAAQ,QAAQ,qBAAqB,EAAU,QAAU,QACzD,MAAC,IAAD,KAAG,iEAID,EAAS,MACP,MAAM,EAAO,CACjB,GAAI,CACF,SAAI,GAAK,KAAM,GAAU,EAAU,KAEnC,EAAI,MAAM,gBAEV,EAAI,IAAI,QAED,OACF,GADE,CAEL,OAAQ,oBAEH,EAAP,CACA,SAAI,MAAM,YAAa,GAEhB,OACF,GADE,CAEL,OAAQ,YAId,KAAM,EAAO,CACX,GAAI,EAAM,QAAS,CACjB,GAAM,GAAO,EAAY,EAAU,QAAQ,KAAK,IAAK,EAAU,QAAQ,KAAK,KAE5E,WAAW,IAAM,EAAI,IAAI,aAAc,GAGzC,MAAO,IAET,UAAW,EAAO,CAChB,GAAM,GAAQ,EACZ,EAAU,QAAQ,OAAO,IACzB,EAAU,QAAQ,OAAO,KAG3B,SAAI,KAAK,aAAc,GAEvB,EAAI,GAAG,KAAK,OAAQ,GAEpB,EAAI,IAAI,QAED,GAET,OAAQ,EAAO,CACb,GAAM,GAAW,OACZ,GADY,CAEf,QAAS,CAAC,EAAM,UAGlB,MAAI,GAAS,SACX,WAAW,IAAM,EAAI,IAAI,QAAS,GAG7B,IAIL,EAAM,IAAI,MACd,EAAU,SACV,CAAE,OAAQ,aAAc,QAAS,IACjC,EACA,GAGF,EAAI,IAAI",
  "names": []
}
