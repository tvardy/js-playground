{
  "version": 3,
  "sources": ["../src/js/components/lz-u_login.js", "../src/js/components/lz-u_message.js", "../src/js/components/lz-u_chat.js", "../src/js/lz-chat_apprun.js"],
  "sourcesContent": ["/* global app */\nimport { html } from 'uhtml'\n\nconst view = html`\n  <form class=\"box wide login\" onSubmit=${(e) => app.run('login', e)}>\n    <input name=\"user\" placeholder=\"Your nickname\" />\n  </form>\n`\n\nexport default view\n", "import { html } from 'uhtml'\n\nconst view = (userId, message) => html`\n  <div\n    class=\"message\"\n    data-self=${message.user.id === userId}\n    data-user=${message.user.name}\n  >\n    ${message.msg}\n  </div>\n`\n\nexport default view\n", "/* global app */\nimport { html } from 'uhtml'\n\nimport Message from './lz-u_message'\n\nconst view = (status, user, messages) => html`\n  <section class=\"box wide chat-box\" data-status=${status}>\n    ${messages.map((message) => Message(user.id, message))}\n  </section>\n  <form class=\"box wide message\" onSubmit=${(e) => app.run('send', e)}>\n    <input name=\"msg\" placeholder=\"message box...\" />\n  </form>\n`\n\nexport default view\n", "/* global app */\nimport { LEVELS, Log } from './tools/Logger'\nimport { render, html } from 'uhtml'\n\nimport { constants, state } from './lz-chat_common'\nimport { wsConnect } from './utils/wsConnect'\nimport { pack, unpack } from './utils/lzip.js'\n\nimport Login from './components/lz-u_login'\nimport Chat from './components/lz-u_chat'\n\nif (process.env.NODE_ENV === 'development') {\n  Log.logLevel = LEVELS.DEBUG\n}\n\nLog.debug('LZ Chat AppRun started!')\n\napp.render = render\nconst rootElem = document.getElementById('apprun')\n\nconst actions = {\n  login (state, e) {\n    e.preventDefault()\n\n    const name = e.target.elements.user.value\n\n    App.run('connecting')\n\n    wsConnect(constants.URL)\n      .then((sock) => {\n        App.sock = sock\n\n        App.sock.on('message', (msg) => {\n          App.run('message', unpack(msg))\n        })\n\n        App.run('connected', { id: sock.id, name })\n      })\n      .catch((e) => {\n        Log.error('WS error:', e)\n\n        App.run('error')\n      })\n  },\n  connecting (state) {\n    return {\n      ...state,\n      status: 'connecting'\n    }\n  },\n  connected (state, user) {\n    Log.debug('AppRun connected:', user)\n\n    return {\n      ...state,\n      status: 'connected',\n      user\n    }\n  },\n  error () {\n    return {\n      ...state,\n      status: 'error'\n    }\n  },\n  send (state, e) {\n    e.preventDefault()\n\n    const msg = e.target.elements.msg.value\n    const data = { user: state.user, msg }\n\n    e.target.elements.msg.value = ''\n\n    Log.debug('AppRun send:', msg)\n\n    App.sock.emit('message', pack(data))\n    App.run('message', data)\n  },\n  message (state, data) {\n    Log.debug('AppRun message:', data.user, data.msg)\n\n    App.run('align')\n\n    return {\n      ...state,\n      messages: state.messages.concat(data)\n    }\n  },\n  align () {\n    const box = rootElem.querySelector('.chat-box')\n\n    setTimeout(() => {\n      if (box.scrollTop < box.scrollHeight) {\n        box.scrollTop = box.scrollHeight\n      }\n    }, 0)\n  }\n}\n\nconst view = (state) =>\n  html`${state.status === 'login'\n    ? Login\n    : Chat(state.status, state.user, state.messages)}`\n\nconst App = app.start(rootElem, state, view, actions)\n"],
  "mappings": "6PAGA,GAAM,GAAO;AAAA,0CAC6B,AAAC,GAAM,IAAI,IAAI,QAAS;AAAA;AAAA;AAAA,EAK3D,EAAQ,ECPf,GAAM,GAAO,CAAC,EAAQ,IAAY;AAAA;AAAA;AAAA,gBAGlB,EAAQ,KAAK,KAAO;AAAA,gBACpB,EAAQ,KAAK;AAAA;AAAA,MAEvB,EAAQ;AAAA;AAAA,EAIP,EAAQ,ECPf,GAAM,GAAO,CAAC,EAAQ,EAAM,IAAa;AAAA,mDACU;AAAA,MAC7C,EAAS,IAAI,AAAC,GAAY,EAAQ,EAAK,GAAI;AAAA;AAAA,4CAEL,AAAC,GAAM,IAAI,IAAI,OAAQ;AAAA;AAAA;AAAA,EAK5D,EAAQ,ECCf,EAAI,MAAM,2BAEV,IAAI,OAAS,EACb,GAAM,GAAW,SAAS,eAAe,UAEnC,EAAU,CACd,MAAO,EAAO,EAAG,CACf,EAAE,iBAEF,GAAM,GAAO,EAAE,OAAO,SAAS,KAAK,MAEpC,EAAI,IAAI,cAER,EAAU,EAAU,KACjB,KAAK,AAAC,GAAS,CACd,EAAI,KAAO,EAEX,EAAI,KAAK,GAAG,UAAW,AAAC,GAAQ,CAC9B,EAAI,IAAI,UAAW,EAAO,MAG5B,EAAI,IAAI,YAAa,CAAE,GAAI,EAAK,GAAI,WAErC,MAAM,AAAC,GAAM,CACZ,EAAI,MAAM,YAAa,GAEvB,EAAI,IAAI,YAGd,WAAY,EAAO,CACjB,MAAO,QACF,GADE,CAEL,OAAQ,gBAGZ,UAAW,EAAO,EAAM,CACtB,SAAI,MAAM,oBAAqB,GAExB,OACF,GADE,CAEL,OAAQ,YACR,UAGJ,OAAS,CACP,MAAO,QACF,GADE,CAEL,OAAQ,WAGZ,KAAM,EAAO,EAAG,CACd,EAAE,iBAEF,GAAM,GAAM,EAAE,OAAO,SAAS,IAAI,MAC5B,EAAO,CAAE,KAAM,EAAM,KAAM,OAEjC,EAAE,OAAO,SAAS,IAAI,MAAQ,GAE9B,EAAI,MAAM,eAAgB,GAE1B,EAAI,KAAK,KAAK,UAAW,EAAK,IAC9B,EAAI,IAAI,UAAW,IAErB,QAAS,EAAO,EAAM,CACpB,SAAI,MAAM,kBAAmB,EAAK,KAAM,EAAK,KAE7C,EAAI,IAAI,SAED,OACF,GADE,CAEL,SAAU,EAAM,SAAS,OAAO,MAGpC,OAAS,CACP,GAAM,GAAM,EAAS,cAAc,aAEnC,WAAW,IAAM,CACf,AAAI,EAAI,UAAY,EAAI,cACtB,GAAI,UAAY,EAAI,eAErB,KAID,EAAO,AAAC,GACZ,IAAO,EAAM,SAAW,QACpB,EACA,EAAK,EAAM,OAAQ,EAAM,KAAM,EAAM,YAErC,EAAM,IAAI,MAAM,EAAU,EAAO,EAAM",
  "names": []
}
